# RL | 2025-01-18

## Proof: DP algorithm

For any admissible $\pi = \{ \mu_0, \mu_1, \dots, \mu_{N-1} \}$, let $\pi^k = \{ \mu_k, \mu_{k+1}, \dots, \mu_{N-1} \}, \ k = 0, 1, \dots, N-1$. [$\pi^k \to \text{`pi sup k'}$]. Let

$$
\underbrace{ \large J_k^*(x_k) }_{\begin{split}\text{Optimal cost for the } \\ (N-k) \text{ stage subproblem}\end{split}} = \min_{\pi^k} \operatorname{\large E} \left[ g_N(X_N) + \sum_{i=k}^{N-1} g_i(X_i, \mu_i(X_i), X_{i+1}) \Bigg| X_k = x_k \right]
$$

Let $J_N^*(x_N) = g_N(x_n) = J_N(x_N), \ \forall \ x_N \in S$

We will show by ~mathematical induction that $J_k^*(x_k) = J_k(x_k), \ \forall \ x_k \in S, \ \forall \ k \geq 0$

Assume that for some $k$ and all $x_{k+1}$,

$$
J_{k+1}^*(x_{k+1}) = J_{k+1}(x_{k+1})
$$

Note that $\pi^k = \{ \mu_k, \pi^{k+1} \}$. Thus, for all $x_k$,

$$
\small
\begin{aligned}
J_k^*(x_k)
& =
\min_{\{ \mu_k, \pi^{k+1} \}} \operatorname{E}_{X_{k+1}, \dots, X_N} \left[ \left. g_N(X_N) + g_k(X_k, \mu_k(X_k), X_{k+1}) + \sum_{i=k+1}^{N-1} g_i(X_i, \mu_i(X_i), X_{i+1}) \right| X_k = x_k \right]
\\ & =
\min_{\{ \mu_k, \pi^{k+1} \}} \operatorname{E}_{X_{k+1}} \left[ \left. g_k(X_k, \mu_k(X_k), X_{k+1}) + \operatorname{E}_{X_{k+2}, \dots, X_N} \left[ \left. g_N(X_N) + \sum_{i=k+1}^{N-1} g_i(X_i, \mu_i(X_i), X_{i+1}) \right| X_{k+1} \right] \right| X_k = x_k \right]
\\ & =
\min_{\mu_k} \operatorname{E}_{X_{k+1}} \left[ \left. g_k(X_k, \mu_k(X_k), X_{k+1}) + \underbrace{ \left( \min_{\pi^{k+1}} \operatorname{E}_{X_{k+2}, \dots, X_N} \left[ \left. g_N(X_N) + \sum_{i=k+1}^{N-1} g_i(X_i, \mu_i(X_i), X_{i+1}) \right|  X_{k+1} \right] \right) }_{= \ J_{k+1}^*(x_{k+1}) \ \ = \ J_{k+1}(x_{k+1}) \ \ \text{ by induction hypothesis}} \right| X_k = x_k  \right]
\end{aligned}
$$

Thus,

$$
J_k^*(x_k) = \min_{\mu_k} \operatorname{E}_{X_{k+1}} \Big[ g_k(X_k, \mu_k(X_k), X_{k+1}) + J_{k+1}^*(x_{k+1}) \Big| X_k = x_k  \Big]
$$

## Example: Chess match between player and opponent

**Aim:** Formulate an optimal control strategy for player.

## Example: Control of a queue

~ Network queue, Routing queue, stand in line queue, etc.

Assume buffer size is $n$.

---

